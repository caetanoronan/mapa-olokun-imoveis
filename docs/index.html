<!DOCTYPE html>
<html>
<head>
    <title>Mapa Interativo Olokun Im√≥veis</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="leaflet/leaflet.css" />
    <script src="leaflet/leaflet.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        .header {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10000;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            font-family: 'Arial', sans-serif;
            max-width: 280px;
            font-size: 13px;
        }
        .header h2 {
            margin: 0 0 8px 0;
            color: #2c3e50;
            font-size: 16px;
        }
        .header p {
            margin: 3px 0;
            color: #34495e;
        }
        .header .contact {
            margin-top: 8px;
            padding-top: 6px;
            border-top: 1px solid #ecf0f1;
        }
        .legend {
            position: absolute;
            bottom: 10px;
            right: 10px;
            z-index: 9999;
            background: white;
            padding: 10px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            font-size: 13px;
            max-width: 180px;
        }
        .legend ul {
            padding-left: 0;
            margin: 6px 0 0 0;
            list-style: none;
        }
        .legend li {
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 12px;
        }
        .legend-dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2>üè† Olokun Im√≥veis + OLX</h2>
        <p><strong>Im√≥veis exclusivos + Ofertas do mercado</strong></p>
        <div class="contact">
            <p>üìû (48) 99999-9999</p>
            <p>üìß contato@olokunimoveis.com.br</p>
            <p>üìç Florian√≥polis/SC</p>
        </div>
    </div>

    <div id="map"></div>

    <div class="legend">
        <b>üè† Fontes de Im√≥veis</b>
        <ul>
            <li onclick="toggleLayer('olokun')"><span class="legend-dot" style="background-color:#3498db;"></span>Olokun Im√≥veis</li>
            <li onclick="toggleLayer('olx')"><span class="legend-dot" style="background-color:#ff6b35;"></span>OLX</li>
        </ul>
        <p style="margin:6px 0 0 0; font-size:11px; color:#7f8c8d;">Clique para mostrar/ocultar</p>
    </div>

    <script>
        console.log('Script carregado, aguardando DOM...');

        // Aguardar o DOM estar pronto
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM carregado, iniciando mapa...');
            initMap();
        });

        function initMap() {
            console.log('Script iniciado...');

            // Verificar se Leaflet est√° carregado
            if (typeof L === 'undefined') {
                console.error('Leaflet n√£o est√° carregado!');
                document.getElementById('map').innerHTML = '<h2 style="color:red; text-align:center; padding:50px;">ERRO: Biblioteca Leaflet n√£o carregou!</h2>';
                return;
            } else {
                console.log('Leaflet carregado:', L.version);
            }

            try {
                // Verificar se o elemento do mapa existe
                var mapElement = document.getElementById('map');
                if (!mapElement) {
                    console.error('Elemento #map n√£o encontrado!');
                    return;
                }

                // Inicializar mapa
                console.log('Inicializando mapa...');
                var map = L.map('map').setView([-27.5954, -48.5480], 12);
                console.log('Mapa criado:', map);

                // Adicionar tile layer
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);

                console.log('Tile layer adicionado');

                // Definir limites de zoom
                map.options.minZoom = 10;
                map.options.maxZoom = 18;

                

// Dados dos im√≥veis
var imoveis = [
  {
    "tipo": "Casa",
    "endereco": "Rua das Flores, 100, Florian√≥polis",
    "lat": -27.4305001,
    "lng": -48.4659858,
    "cor": "#1f77b4",
    "area": "200m¬≤",
    "quartos": 3,
    "banheiros": 2,
    "vagas": 2,
    "valor": "R$ 550.000",
    "descricao": "Linda casa com jardim e garagem",
    "foto": "https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=300",
    "fonte": "Olokun Im√≥veis"
  },
  {
    "tipo": "Apartamento",
    "endereco": "Avenida Beira Mar, 500, Florian√≥polis",
    "lat": -27.6023224,
    "lng": -48.6026133,
    "cor": "#2ca02c",
    "area": "70m¬≤",
    "quartos": 2,
    "banheiros": 1,
    "vagas": 1,
    "valor": "R$ 300.000",
    "descricao": "Apartamento com vista para o mar",
    "foto": "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=300",
    "fonte": "Olokun Im√≥veis"
  },
  {
    "tipo": "Sala Comercial",
    "endereco": "Rua XV de Novembro, 20, Centro, Florian√≥polis",
    "lat": -27.597,
    "lng": -48.549,
    "cor": "#ff7f0e",
    "area": "40m¬≤",
    "quartos": 0,
    "banheiros": 1,
    "vagas": 0,
    "valor": "R$ 1.200/m√™s",
    "descricao": "Sala comercial bem localizada",
    "foto": "https://images.unsplash.com/photo-1497366754035-f200968a6e72?w=300",
    "fonte": "Olokun Im√≥veis"
  },
  {
    "tipo": "Terreno",
    "endereco": "Estrada Geral, Ratones, Florian√≥polis",
    "lat": -27.5045161,
    "lng": -48.4903989,
    "cor": "#d62728",
    "area": "500m¬≤",
    "quartos": 0,
    "banheiros": 0,
    "vagas": 0,
    "valor": "R$ 150.000",
    "descricao": "Terreno plano para constru√ß√£o",
    "foto": "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=300",
    "fonte": "Olokun Im√≥veis"
  },
  {
    "tipo": "Galp√£o Industrial",
    "endereco": "Rodovia SC-401, km 5, Florian√≥polis",
    "lat": -27.5401647,
    "lng": -48.5054413,
    "cor": "#9467bd",
    "area": "600m¬≤",
    "quartos": 0,
    "banheiros": 2,
    "vagas": 5,
    "valor": "R$ 850.000",
    "descricao": "Galp√£o industrial com doca",
    "foto": "https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=300",
    "fonte": "Olokun Im√≥veis"
  },
  {
    "titulo": "Apartamento 2 quartos Centro - Excelente localiza√ß√£o",
    "preco": "R$ 450.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/apartamento-2-quartos-centro-excelente-localizacao",
    "localizacao": "Centro, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.5972029,
    "lng": -48.5494815,
    "cor": "#3498db",
    "area": "65m¬≤",
    "quartos": 2,
    "banheiros": 1,
    "vagas": 1,
    "foto": "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=300"
  },
  {
    "titulo": "Casa 3 quartos Lagoa da Concei√ß√£o - Vista para o mar",
    "preco": "R$ 850.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/casa-3-quartos-lagoa-conceicao-vista-mar",
    "localizacao": "Lagoa da Concei√ß√£o, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.5697194,
    "lng": -48.4515809,
    "cor": "#e74c3c",
    "area": "180m¬≤",
    "quartos": 3,
    "banheiros": 2,
    "vagas": 2,
    "foto": "https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=300"
  },
  {
    "titulo": "Sala comercial Rua XV de Novembro - Centro Hist√≥rico",
    "preco": "R$ 2.500/m√™s",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/sala-comercial-rua-xv-novembro-centro-historico",
    "localizacao": "Centro Hist√≥rico, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.5972029,
    "lng": -48.5494815,
    "cor": "#f39c12",
    "area": "45m¬≤",
    "quartos": 0,
    "banheiros": 1,
    "vagas": 0,
    "foto": "https://images.unsplash.com/photo-1497366754035-f200968a6e72?w=300"
  },
  {
    "titulo": "Terreno 300m¬≤ Santo Ant√¥nio de Lisboa",
    "preco": "R$ 180.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/terreno-300m2-santo-antonio-lisboa",
    "localizacao": "Santo Ant√¥nio de Lisboa, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.5061508,
    "lng": -48.5188698,
    "cor": "#27ae60",
    "area": "300m¬≤",
    "quartos": 0,
    "banheiros": 0,
    "vagas": 0,
    "foto": "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=300"
  },
  {
    "titulo": "Galp√£o industrial 500m¬≤ Distrito Industrial",
    "preco": "R$ 750.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/galpao-industrial-500m2-distrito-industrial",
    "localizacao": "Distrito Industrial, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.5401647,
    "lng": -48.5054413,
    "cor": "#9b59b6",
    "area": "500m¬≤",
    "quartos": 0,
    "banheiros": 2,
    "vagas": 4,
    "foto": "https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=300"
  },
  {
    "titulo": "Apartamento 1 quarto Jurer√™ Internacional",
    "preco": "R$ 320.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/apartamento-1-quarto-jurere-internacional",
    "localizacao": "Jurer√™ Internacional, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.46,
    "lng": -48.5,
    "cor": "#1abc9c",
    "area": "45m¬≤",
    "quartos": 1,
    "banheiros": 1,
    "vagas": 1,
    "foto": "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=300"
  },
  {
    "titulo": "Casa 4 quartos Campeche - Pr√≥ximo √† praia",
    "preco": "R$ 920.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/casa-4-quartos-campeche-proximo-praia",
    "localizacao": "Campeche, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.68,
    "lng": -48.49,
    "cor": "#e67e22",
    "area": "220m¬≤",
    "quartos": 4,
    "banheiros": 3,
    "vagas": 2,
    "foto": "https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=300"
  },
  {
    "titulo": "Cobertura duplex Ingleses - Vista panor√¢mica",
    "preco": "R$ 1.200.000",
    "link": "https://www.olx.com.br/sc/florianopolis/imoveis/cobertura-duplex-ingleses-vista-panoramica",
    "localizacao": "Ingleses, Florian√≥polis, SC",
    "fonte": "OLX",
    "tipo": "simulado",
    "lat": -27.43,
    "lng": -48.39,
    "cor": "#34495e",
    "area": "150m¬≤",
    "quartos": 3,
    "banheiros": 2,
    "vagas": 2,
    "foto": "https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=300"
  }
];

// Criar camadas para cada fonte
var layers = {
    olokun: L.layerGroup(),
    olx: L.layerGroup()
};

console.log('Camadas criadas:', Object.keys(layers));

// Adicionar marcadores
imoveis.forEach(function(imovel, index) {
    console.log('Processando im√≥vel', index + 1, ':', imovel.titulo || imovel.tipo);

    var tipoLayer = imovel.fonte === 'OLX' ? 'olx' : 'olokun';

    var marker = L.circleMarker([imovel.lat, imovel.lng], {
        color: imovel.cor,
        fillColor: imovel.cor,
        fillOpacity: 0.8,
        radius: imovel.fonte === 'OLX' ? 6 : 8,  // Marcadores menores para OLX
        weight: 2
    });

    console.log('Marcador criado para coordenadas:', imovel.lat, imovel.lng);

    var popupContent;
    if (imovel.fonte === 'OLX') {
        popupContent = `
            <div style="width:280px; font-family:Arial, sans-serif;">
                <div style="background:#ff6b35; color:white; padding:4px 8px; border-radius:3px; display:inline-block; font-size:10px; margin-bottom:6px;">OLX</div>
                <h4 style="margin:0 0 8px 0; color:#2c3e50; font-size:14px;">${imovel.titulo}</h4>
                <img src="${imovel.foto}" width="260" height="160" style="border-radius:3px; margin-bottom:8px; object-fit:cover;">
                <p style="margin:3px 0; font-size:12px;"><strong>Localiza√ß√£o:</strong> ${imovel.localizacao}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>√Årea:</strong> ${imovel.area}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Quartos:</strong> ${imovel.quartos}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Banheiros:</strong> ${imovel.banheiros}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Vagas:</strong> ${imovel.vagas}</p>
                <p style="margin:3px 0; font-size:16px; color:#e74c3c; font-weight:bold;"><strong>Valor:</strong> ${imovel.preco || imovel.valor}</p>
                <a href="${imovel.link}" target="_blank" style="background:#ff6b35; color:white; border:none; padding:8px 16px; border-radius:3px; cursor:pointer; font-size:12px; text-decoration:none; display:inline-block; margin-top:8px;">Ver na OLX</a>
            </div>
        `;
    } else {
        popupContent = `
            <div style="width:250px; font-family:Arial, sans-serif;">
                <div style="background:#3498db; color:white; padding:4px 8px; border-radius:3px; display:inline-block; font-size:10px; margin-bottom:6px;">Olokun Im√≥veis</div>
                <h4 style="margin:0 0 8px 0; color:#2c3e50; font-size:14px;">${imovel.tipo}</h4>
                <img src="${imovel.foto}" width="230" height="150" style="border-radius:3px; margin-bottom:8px; object-fit:cover;">
                <p style="margin:3px 0; font-size:12px;"><strong>Endere√ßo:</strong> ${imovel.endereco}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>√Årea:</strong> ${imovel.area}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Quartos:</strong> ${imovel.quartos}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Banheiros:</strong> ${imovel.banheiros}</p>
                <p style="margin:3px 0; font-size:12px;"><strong>Vagas:</strong> ${imovel.vagas}</p>
                <p style="margin:3px 0; font-size:14px; color:#e74c3c;"><strong>Valor:</strong> ${imovel.valor}</p>
                <p style="margin:6px 0; font-style:italic; color:#7f8c8d; font-size:11px;">${imovel.descricao}</p>
                <button onclick="window.open('mailto:contato@olokunimoveis.com.br?subject=Interesse em ${imovel.tipo} - ${imovel.endereco}')" style="background:#3498db; color:white; border:none; padding:6px 12px; border-radius:3px; cursor:pointer; font-size:11px;">üìß Contato</button>
            </div>
        `;
    }

    marker.bindPopup(popupContent);
    marker.addTo(layers[tipoLayer]);
    console.log('Marcador adicionado √† layer:', tipoLayer);
});

console.log('Adicionando camadas ao mapa...');
// Adicionar camadas ao mapa inicialmente
Object.values(layers).forEach(function(layer) {
    layer.addTo(map);
});

console.log('Adicionando controle de camadas...');
// Adicionar controle de camadas
L.control.layers(null, {
    "üè¢ Olokun Im√≥veis": layers.olokun,
    "üü† OLX": layers.olx
}, {collapsed: false}).addTo(map);

console.log('Mapa inicializado com', imoveis.length, 'im√≥veis totais!');
// Fun√ß√£o para alternar camadas (compatibilidade com legenda)
                window.toggleLayer = function(layerName) {
                    console.log('Alternando layer:', layerName);
                    var layer = layers[layerName];
                    if (map.hasLayer(layer)) {
                        map.removeLayer(layer);
                        console.log('Layer removida:', layerName);
                    } else {
                        layer.addTo(map);
                        console.log('Layer adicionada:', layerName);
                    }
                };

                console.log('‚úÖ Mapa inicializado com sucesso!');

            } catch (error) {
                console.error('ERRO ao inicializar mapa:', error);
                document.getElementById('map').innerHTML = '<h2 style="color:red; text-align:center; padding:50px;">ERRO ao carregar mapa: ' + error.message + '</h2>';
            }
        }
    </script>
</body>
</html>